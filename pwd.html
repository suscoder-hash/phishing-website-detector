<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhishGuard - Website Security Scanner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Navigation */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .nav-logo {
            font-size: 1.8em;
            font-weight: bold;
            color: #667eea;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-item {
            cursor: pointer;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover, .nav-item.active {
            background: #667eea;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Page Sections */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .tagline {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            margin-bottom: 30px;
        }

        .scan-section {
            padding: 40px;
            text-align: center;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .scan-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .url-input-container {
            position: relative;
            max-width: 600px;
            margin: 0 auto 20px;
        }

        .url-input {
            width: 100%;
            padding: 15px 20px;
            font-size: 1.1em;
            border: 2px solid #e0e6ed;
            border-radius: 50px;
            outline: none;
            transition: all 0.3s ease;
        }

        .url-input:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
        }

        .scan-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .scan-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(102, 126, 234, 0.4);
        }

        .scan-button:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .results-section {
            padding: 40px;
            display: none;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ecf0f1;
        }

        .scanned-url {
            font-size: 1.2em;
            color: #2c3e50;
            word-break: break-all;
        }

        .scan-time {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .threat-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .threat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #27ae60;
        }

        .threat-card.warning {
            border-left-color: #f39c12;
        }

        .threat-card.danger {
            border-left-color: #e74c3c;
        }

        .threat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .threat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }

        .detection-engines {
            margin-top: 30px;
        }

        .engines-header {
            font-size: 1.4em;
            margin-bottom: 20px;
            color: #2c3e50;
        }

        .engines-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .engine-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .engine-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .engine-card.malicious {
            border-left-color: #e74c3c;
        }

        .engine-card.suspicious {
            border-left-color: #f39c12;
        }

        .engine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .engine-name {
            font-weight: 600;
            font-size: 1em;
        }

        .engine-vendor {
            font-size: 0.8em;
            color: #7f8c8d;
            font-style: italic;
        }

        .engine-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .engine-details {
            margin-top: 8px;
            font-size: 0.85em;
            color: #5a6c7d;
        }

        .engine-detection {
            color: #e74c3c;
            font-weight: 500;
            font-family: 'Courier New', monospace;
        }

        .status-clean {
            background: #d5edda;
            color: #155724;
        }

        .status-malicious {
            background: #f8d7da;
            color: #721c24;
        }

        .status-suspicious {
            background: #fff3cd;
            color: #856404;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            text-align: center;
        }

        .feature-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .feature-title {
            font-size: 1.3em;
            margin-bottom: 15px;
            color: #2c3e50;
        }

        .feature-desc {
            color: #7f8c8d;
            line-height: 1.6;
        }

        /* Statistics Page */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        /* Recent Scans */
        .recent-scans {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .scan-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #ecf0f1;
        }

        .scan-item:last-child {
            border-bottom: none;
        }

        .scan-url {
            font-weight: 500;
            color: #2c3e50;
        }

        .scan-result {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
        }

        /* API Documentation */
        .api-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05);
        }

        .api-endpoint {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            border-left: 4px solid #667eea;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            padding: 30px 30px 20px;
            border-bottom: 2px solid #ecf0f1;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px 15px 0 0;
        }

        .modal-title {
            font-size: 1.5em;
            font-weight: bold;
            margin: 0;
        }

        .close {
            font-size: 2em;
            font-weight: bold;
            cursor: pointer;
            color: white;
            opacity: 0.8;
            transition: opacity 0.3s ease;
        }

        .close:hover {
            opacity: 1;
        }

        .modal-body {
            padding: 30px;
        }

        .detail-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #ecf0f1;
        }

        .detail-section:last-child {
            border-bottom: none;
        }

        .detail-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-clean-badge {
            background: #d5edda;
            color: #155724;
        }

        .status-malicious-badge {
            background: #f8d7da;
            color: #721c24;
        }

        .status-suspicious-badge {
            background: #fff3cd;
            color: #856404;
        }

        .detail-info {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 15px;
            margin-bottom: 15px;
            align-items: start;
        }

        .detail-label {
            font-weight: 600;
            color: #5a6c7d;
        }

        .detail-value {
            color: #2c3e50;
        }

        .detection-details {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #e74c3c;
            margin-top: 10px;
        }

        .detection-name {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            color: #e74c3c;
            margin-bottom: 8px;
        }

        .detection-description {
            color: #5a6c7d;
            line-height: 1.6;
        }

        .threat-indicators {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .threat-indicator {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #3498db;
        }

        .indicator-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #2c3e50;
        }

        .indicator-label {
            font-size: 0.85em;
            color: #7f8c8d;
            margin-top: 5px;
        }

        /* OWASP Specific Styles */
        .owasp-category {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #3498db;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .owasp-category.critical {
            border-left-color: #e74c3c;
        }

        .owasp-category.high {
            border-left-color: #e67e22;
        }

        .owasp-category.medium {
            border-left-color: #f39c12;
        }

        .owasp-category.low {
            border-left-color: #27ae60;
        }

        .owasp-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .owasp-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #2c3e50;
        }

        .severity-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            text-transform: uppercase;
        }

        .severity-critical {
            background: #f8d7da;
            color: #721c24;
        }

        .severity-high {
            background: #ffeaa7;
            color: #d63031;
        }

        .severity-medium {
            background: #fff3cd;
            color: #856404;
        }

        .severity-low {
            background: #d5edda;
            color: #155724;
        }

        .severity-pass {
            background: #d4edda;
            color: #155724;
        }

        .finding-item {
            background: #f8f9fa;
            padding: 12px;
            margin: 10px 0;
            border-radius: 6px;
            font-size: 0.95em;
            color: #5a6c7d;
        }

        .suggestion-item {
            background: #e3f2fd;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
        }

        .suggestion-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 5px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .nav-container {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">üõ°Ô∏è PhishGuard</div>
            <ul class="nav-menu">
                <li class="nav-item active" data-page="scanner">URL Scanner</li>
                <li class="nav-item" data-page="owasp">OWASP Analysis</li>
                <li class="nav-item" data-page="statistics">Statistics</li>
                <li class="nav-item" data-page="recent">Recent Scans</li>
                <li class="nav-item" data-page="api">API Docs</li>
                <li class="nav-item" data-page="about">About</li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <!-- Scanner Page -->
        <div class="page-section active" id="scanner">
            <div class="header">
                <div class="logo">üõ°Ô∏è PhishGuard</div>
                <div class="tagline">Advanced Phishing & Malware Detection</div>
            </div>

            <div class="main-card">
                <div class="scan-section">
                    <h2 class="scan-title">Analyze suspicious URLs and websites</h2>
                    <div class="url-input-container">
                        <input type="url" class="url-input" id="urlInput" placeholder="Enter URL (e.g., https://example.com)">
                    </div>
                    <button class="scan-button" id="scanButton">üîç Scan Website</button>
                </div>

                <div class="loading" id="loadingSection" style="display: none;">
                    <div class="spinner"></div>
                    <p>Analyzing website security...</p>
                </div>

                <div class="results-section" id="resultsSection">
                    <div class="results-header">
                        <div class="scanned-url" id="scannedUrl">https://example.com</div>
                        <div class="scan-time" id="scanTime">Scanned: 2 minutes ago</div>
                    </div>

                    <div class="threat-overview">
                        <div class="threat-card">
                            <div class="threat-number" style="color: #27ae60;" id="cleanEngines">37</div>
                            <div class="threat-label">Security vendors flagged this URL as clean</div>
                        </div>
                        <div class="threat-card warning">
                            <div class="threat-number" style="color: #f39c12;" id="suspiciousEngines">3</div>
                            <div class="threat-label">Security vendors flagged this URL as suspicious</div>
                        </div>
                        <div class="threat-card danger">
                            <div class="threat-number" style="color: #e74c3c;" id="maliciousEngines">2</div>
                            <div class="threat-label">Security vendors flagged this URL as malicious</div>
                        </div>
                        <div class="threat-card" style="border-left-color: #3498db;">
                            <div class="threat-number" style="color: #3498db;" id="totalEngines">42</div>
                            <div class="threat-label">Total security vendors analyzed this URL</div>
                        </div>
                    </div>

                    <div class="detection-engines">
                        <h3 class="engines-header">Detection Results (<span id="engineCount">42</span> security vendors)</h3>
                        <div class="engines-grid" id="enginesGrid">
                            <!-- Engine results will be populated here -->
                        </div>
                    </div>

                    <div class="additional-info" style="margin-top: 40px;">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px;">üìä Analysis Summary</h4>
                                <div style="margin-bottom: 10px;"><strong>Risk Level:</strong> <span id="riskLevel" style="color: #f39c12; font-weight: bold;">MODERATE</span></div>
                                <div style="margin-bottom: 10px;"><strong>Reputation Score:</strong> <span id="reputationScore">6.2/10</span></div>
                                <div><strong>First Seen:</strong> <span id="firstSeen">2024-11-15</span></div>
                            </div>
                            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                                <h4 style="color: #2c3e50; margin-bottom: 15px;">üåê Domain Information</h4>
                                <div style="margin-bottom: 10px;"><strong>Domain Age:</strong> <span id="domainAge">23 days</span></div>
                                <div style="margin-bottom: 10px;"><strong>SSL Certificate:</strong> <span id="sslStatus" style="color: #27ae60;">Valid</span></div>
                                <div><strong>Server Location:</strong> <span id="serverLocation">United States</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">üîç</div>
                    <h3 class="feature-title">42+ Security Vendors</h3>
                    <p class="feature-desc">Comprehensive analysis using leading security engines from Google, Microsoft, Kaspersky, and many more</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3 class="feature-title">Real-Time Scanning</h3>
                    <p class="feature-desc">Instant URL analysis with live threat intelligence and up-to-date security databases</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3 class="feature-title">Detailed Analysis</h3>
                    <p class="feature-desc">In-depth reports including domain information, SSL status, and threat categorization</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üõ°Ô∏è</div>
                    <h3 class="feature-title">Phishing Detection</h3>
                    <p class="feature-desc">Specialized detection for phishing, scams, malware, and other web-based threats</p>
                </div>
            </div>
        </div>

        <!-- OWASP Analysis Page -->
        <div class="page-section" id="owasp">
            <div class="header">
                <div class="logo">üîí OWASP Top 10 Analysis</div>
                <div class="tagline">Comprehensive Security Vulnerability Assessment</div>
            </div>

            <div class="main-card">
                <div class="scan-section">
                    <h2 class="scan-title">Analyze website security vulnerabilities</h2>
                    <div class="url-input-container">
                        <input type="url" class="url-input" id="owaspUrlInput" placeholder="Enter URL for OWASP analysis (e.g., https://example.com)">
                    </div>
                    <button class="scan-button" id="owaspScanButton">üîí Run OWASP Analysis</button>
                </div>

                <div class="loading" id="owaspLoadingSection" style="display: none;">
                    <div class="spinner"></div>
                    <p>Performing OWASP Top 10 security analysis...</p>
                </div>

                <div class="results-section" id="owaspResultsSection" style="display: none;">
                    <div class="results-header">
                        <div class="scanned-url" id="owaspScannedUrl">https://example.com</div>
                        <div class="scan-time" id="owaspScanTime">Analyzed: Just now</div>
                    </div>

                    <!-- Overall Risk Score -->
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 30px; border-radius: 10px; margin-bottom: 30px; color: white; text-align: center;">
                        <h3 style="margin-bottom: 15px; font-size: 1.5em;">Overall Security Score</h3>
                        <div style="font-size: 4em; font-weight: bold; margin-bottom: 10px;" id="owaspScore">85</div>
                        <div style="font-size: 1.3em; opacity: 0.9;" id="owaspRiskLevel">Medium Risk</div>
                    </div>

                    <!-- OWASP Top 10 Findings -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 1.4em; margin-bottom: 20px; color: #2c3e50;">OWASP Top 10 Vulnerability Assessment</h3>
                        <div id="owaspFindings"></div>
                    </div>

                    <!-- Phishing Indicators -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 1.4em; margin-bottom: 20px; color: #2c3e50;">Phishing Indicators</h3>
                        <div id="phishingIndicators"></div>
                    </div>

                    <!-- Security Suggestions -->
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 1.4em; margin-bottom: 20px; color: #2c3e50;">Security Recommendations</h3>
                        <div id="securitySuggestions"></div>
                    </div>

                    <!-- JSON Export -->
                    <div style="text-align: center; margin-top: 30px;">
                        <button id="exportJsonBtn" style="background: #2c3e50; color: white; border: none; padding: 12px 30px; border-radius: 50px; cursor: pointer; font-size: 1em; font-weight: 500;">
                            üì• Export Full Report (JSON)
                        </button>
                    </div>
                </div>
            </div>

            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3 class="feature-title">OWASP Top 10 Coverage</h3>
                    <p class="feature-desc">Complete analysis based on OWASP 2021 standards including injection, broken access control, and more</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üéØ</div>
                    <h3 class="feature-title">Phishing Detection</h3>
                    <p class="feature-desc">Specialized checks for domain spoofing, fake login forms, and suspicious redirects</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìã</div>
                    <h3 class="feature-title">Actionable Reports</h3>
                    <p class="feature-desc">Detailed findings with severity levels and step-by-step remediation guidance</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3 class="feature-title">Real-Time Analysis</h3>
                    <p class="feature-desc">Instant vulnerability scanning with up-to-date security checks and best practices</p>
                </div>
            </div>
        </div>

        <!-- Statistics Page -->
        <div class="page-section" id="statistics">
            <div class="header">
                <div class="logo">üìä Statistics</div>
                <div class="tagline">PhishGuard Global Security Statistics</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">2,847,592</div>
                    <div class="stat-label">URLs Scanned Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">18,456</div>
                    <div class="stat-label">Malicious URLs Detected</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">42</div>
                    <div class="stat-label">Security Vendors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">99.7%</div>
                    <div class="stat-label">Detection Accuracy</div>
                </div>
            </div>

            <div class="main-card">
                <div style="padding: 40px;">
                    <h2 style="margin-bottom: 30px; color: #2c3e50;">Threat Landscape Overview</h2>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 2em; margin-bottom: 10px;">üé£</div>
                            <h3 style="color: #e74c3c;">Phishing</h3>
                            <p style="color: #7f8c8d; margin-top: 5px;">45% of threats</p>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 2em; margin-bottom: 10px;">ü¶†</div>
                            <h3 style="color: #f39c12;">Malware</h3>
                            <p style="color: #7f8c8d; margin-top: 5px;">28% of threats</p>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 2em; margin-bottom: 10px;">üí∞</div>
                            <h3 style="color: #9b59b6;">Scams</h3>
                            <p style="color: #7f8c8d; margin-top: 5px;">18% of threats</p>
                        </div>
                        <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                            <div style="font-size: 2em; margin-bottom: 10px;">‚ö†Ô∏è</div>
                            <h3 style="color: #34495e;">Other</h3>
                            <p style="color: #7f8c8d; margin-top: 5px;">9% of threats</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Scans Page -->
        <div class="page-section" id="recent">
            <div class="header">
                <div class="logo">üïê Recent Scans</div>
                <div class="tagline">Latest Security Analysis Results</div>
            </div>

            <div class="recent-scans">
                <h2 style="margin-bottom: 30px; color: #2c3e50;">Recent URL Analysis</h2>
                <div class="scan-item">
                    <div class="scan-url">https://secure-bank-login.suspicious.com</div>
                    <div class="scan-result status-malicious">MALICIOUS</div>
                </div>
                <div class="scan-item">
                    <div class="scan-url">https://google.com</div>
                    <div class="scan-result status-clean">CLEAN</div>
                </div>
                <div class="scan-item">
                    <div class="scan-url">https://new-crypto-exchange.example.org</div>
                    <div class="scan-result status-suspicious">SUSPICIOUS</div>
                </div>
                <div class="scan-item">
                    <div class="scan-url">https://github.com</div>
                    <div class="scan-result status-clean">CLEAN</div>
                </div>
                <div class="scan-item">
                    <div class="scan-url">https://fake-paypal-verification.phish.net</div>
                    <div class="scan-result status-malicious">MALICIOUS</div>
                </div>
                <div class="scan-item">
                    <div class="scan-url">https://stackoverflow.com</div>
                    <div class="scan-result status-clean">CLEAN</div>
                </div>
            </div>
        </div>

        <!-- API Documentation Page -->
        <div class="page-section" id="api">
            <div class="header">
                <div class="logo">üîå API Documentation</div>
                <div class="tagline">Integrate PhishGuard into your applications</div>
            </div>

            <div class="api-section">
                <h2 style="margin-bottom: 20px; color: #2c3e50;">Getting Started</h2>
                <p style="margin-bottom: 20px; color: #7f8c8d; line-height: 1.6;">
                    The PhishGuard API provides programmatic access to our URL scanning and threat detection capabilities. 
                    Get real-time security analysis for any URL with a simple REST API.
                </p>
                
                <h3 style="margin: 30px 0 15px; color: #2c3e50;">Base URL</h3>
                <div class="api-endpoint">https://api.phishguard.com/v1</div>

                <h3 style="margin: 30px 0 15px; color: #2c3e50;">Authentication</h3>
                <p style="margin-bottom: 15px; color: #7f8c8d;">Include your API key in the request header:</p>
                <div class="code-block">X-API-Key: YOUR_API_KEY_HERE</div>

                <h3 style="margin: 30px 0 15px; color: #2c3e50;">Scan URL</h3>
                <div class="api-endpoint">POST /scan</div>
                <div class="code-block">{
  "url": "https://example.com",
  "force_rescan": false
}</div>

                <h3 style="margin: 30px 0 15px; color: #2c3e50;">Get Scan Results</h3>
                <div class="api-endpoint">GET /scan/{scan_id}</div>
                
                <h3 style="margin: 30px 0 15px; color: #2c3e50;">Example Response</h3>
                <div class="code-block">{
  "scan_id": "abc123def456",
  "url": "https://example.com",
  "status": "completed",
  "risk_level": "low",
  "reputation_score": 8.5,
  "detections": {
    "clean": 38,
    "suspicious": 2,
    "malicious": 2
  },
  "engines": [
    {
      "name": "Google Safe Browsing",
      "status": "clean",
      "detection": null
    }
  ]
}</div>
            </div>

            <div class="api-section">
                <h2 style="margin-bottom: 20px; color: #2c3e50;">Rate Limits</h2>
                <p style="color: #7f8c8d; line-height: 1.6;">
                    Free tier: 100 requests per hour<br>
                    Pro tier: 1,000 requests per hour<br>
                    Enterprise: Custom limits available
                </p>
            </div>
        </div>

        <!-- About Page -->
        <div class="page-section" id="about">
            <div class="header">
                <div class="logo">‚ÑπÔ∏è About PhishGuard</div>
                <div class="tagline">Protecting users from online threats</div>
            </div>

            <div class="main-card">
                <div style="padding: 40px;">
                    <h2 style="margin-bottom: 30px; color: #2c3e50;">Our Mission</h2>
                    <p style="color: #7f8c8d; line-height: 1.8; margin-bottom: 30px; font-size: 1.1em;">
                        PhishGuard is dedicated to making the internet safer by providing comprehensive URL analysis 
                        and threat detection services. We combine the power of 42+ security vendors to deliver 
                        accurate, real-time protection against phishing, malware, and other web-based threats.
                    </p>

                    <h3 style="margin-bottom: 20px; color: #2c3e50;">Key Features</h3>
                    <ul style="color: #7f8c8d; line-height: 1.8; margin-bottom: 30px; padding-left: 20px;">
                        <li>Multi-vendor security analysis</li>
                        <li>Real-time threat detection</li>
                        <li>Comprehensive reporting</li>
                        <li>API integration</li>
                        <li>Enterprise-grade security</li>
                    </ul>

                    <h3 style="margin-bottom: 20px; color: #2c3e50;">Security Partners</h3>
                    <p style="color: #7f8c8d; line-height: 1.8;">
                        We work with leading security vendors including Google Safe Browsing, Microsoft Defender, 
                        Kaspersky, Bitdefender, and many others to provide the most comprehensive threat detection available.
                    </p>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 PhishGuard. Protecting users from online threats.</p>
        </div>
    </div>

    <!-- Vendor Detail Modal -->
    <div id="vendorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalVendorName">Vendor Analysis Details</h2>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <div class="detail-title">
                        <span>üõ°Ô∏è Detection Status</span>
                        <span class="status-badge" id="modalStatusBadge">Clean</span>
                    </div>
                    <div class="detail-info">
                        <div class="detail-label">Vendor:</div>
                        <div class="detail-value" id="modalVendor">Google</div>
                    </div>
                    <div class="detail-info">
                        <div class="detail-label">Category:</div>
                        <div class="detail-value" id="modalCategory">URL Reputation</div>
                    </div>
                    <div class="detail-info">
                        <div class="detail-label">Last Update:</div>
                        <div class="detail-value" id="modalLastUpdate">2024-12-08</div>
                    </div>
                </div>

                <div class="detail-section" id="threatSection">
                    <div class="detail-title">‚ö†Ô∏è Threat Details</div>
                    <div class="detection-details" id="detectionDetails">
                        <div class="detection-name" id="detectionName">No threats detected</div>
                        <div class="detection-description" id="detectionDescription">
                            This URL appears to be safe and legitimate according to our analysis.
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-title">üìä Analysis Metrics</div>
                    <div class="threat-indicators">
                        <div class="threat-indicator">
                            <div class="indicator-value" id="riskScore">Low</div>
                            <div class="indicator-label">Risk Level</div>
                        </div>
                        <div class="threat-indicator">
                            <div class="indicator-value" id="confidenceScore">High</div>
                            <div class="indicator-label">Confidence</div>
                        </div>
                        <div class="threat-indicator">
                            <div class="indicator-value" id="severityScore">None</div>
                            <div class="indicator-label">Severity</div>
                        </div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-title">üîç Technical Information</div>
                    <div class="detail-info">
                        <div class="detail-label">Analysis Method:</div>
                        <div class="detail-value" id="analysisMethod">Real-time URL reputation check</div>
                    </div>
                    <div class="detail-info">
                        <div class="detail-label">Database Version:</div>
                        <div class="detail-value" id="dbVersion">Latest</div>
                    </div>
                    <div class="detail-info">
                        <div class="detail-label">Scan Duration:</div>
                        <div class="detail-value" id="scanDuration">0.8 seconds</div>
                    </div>
                </div>

                <div class="detail-section">
                    <div class="detail-title">üìã Recommendations</div>
                    <div style="color: #5a6c7d; line-height: 1.6;" id="recommendations">
                        Based on our analysis, this URL appears safe to visit. Continue with normal browsing.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced security engines with detailed detection info
        const securityEngines = [
            { name: 'Google Safe Browsing', vendor: 'Google', category: 'URL Reputation', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Microsoft Defender SmartScreen', vendor: 'Microsoft', category: 'Web Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Kaspersky Web Anti-Virus', vendor: 'Kaspersky', category: 'Anti-Malware', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Bitdefender TrafficLight', vendor: 'Bitdefender', category: 'Web Security', status: 'malicious', detection: 'Phishing.Generic.Suspicious', lastUpdate: '2024-12-08' },
            { name: 'Norton Safe Web', vendor: 'Norton', category: 'URL Analysis', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Avira Browser Safety', vendor: 'Avira', category: 'Web Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Sophos Web Protection', vendor: 'Sophos', category: 'Enterprise Security', status: 'suspicious', detection: 'Suspicious.Domain.NewlyRegistered', lastUpdate: '2024-12-08' },
            { name: 'Trend Micro Web Reputation', vendor: 'Trend Micro', category: 'Cloud Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'McAfee WebAdvisor', vendor: 'McAfee', category: 'Web Safety', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'ESET Online Scanner', vendor: 'ESET', category: 'Anti-Malware', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Malwarebytes Anti-Malware', vendor: 'Malwarebytes', category: 'Malware Detection', status: 'suspicious', detection: 'PUP.Optional.Redirect', lastUpdate: '2024-12-08' },
            { name: 'F-Secure Web Protection', vendor: 'F-Secure', category: 'Internet Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Symantec Web Security', vendor: 'Broadcom', category: 'Enterprise Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Panda Dome Web Protection', vendor: 'Panda Security', category: 'Cloud AV', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'AVG Web TuneUp', vendor: 'AVG', category: 'Web Optimization', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Avast Online Security', vendor: 'Avast', category: 'Browser Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Fortinet FortiGuard', vendor: 'Fortinet', category: 'Web Filtering', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Check Point ZoneAlarm', vendor: 'Check Point', category: 'Firewall Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Comodo Secure DNS', vendor: 'Comodo', category: 'DNS Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'DrWeb Link Checker', vendor: 'Doctor Web', category: 'Anti-Virus', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'G Data WebProtection', vendor: 'G Data', category: 'Internet Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Webroot SecureAnywhere', vendor: 'Webroot', category: 'Cloud Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Yandex Protect', vendor: 'Yandex', category: 'Safe Browsing', status: 'malicious', detection: 'Phishing.Scam.Finance', lastUpdate: '2024-12-08' },
            { name: 'Sucuri SiteCheck', vendor: 'Sucuri', category: 'Website Security', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'PhishTank', vendor: 'OpenDNS', category: 'Phishing Database', status: 'suspicious', detection: 'Phishing.Suspicious.NewDomain', lastUpdate: '2024-12-08' },
            { name: 'SURBL', vendor: 'SURBL', category: 'URI Blacklist', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Spamhaus DBL', vendor: 'Spamhaus', category: 'Domain Blacklist', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Blueliv Threat Intelligence', vendor: 'Blueliv', category: 'Threat Intel', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'URLVoid', vendor: 'NoVirusThanks', category: 'URL Analysis', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Trustwave Secure Web Gateway', vendor: 'Trustwave', category: 'Web Gateway', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'AlienVault OTX', vendor: 'AT&T Cybersecurity', category: 'Threat Exchange', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Cisco Talos', vendor: 'Cisco', category: 'Intelligence', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'IBM X-Force', vendor: 'IBM', category: 'Threat Intelligence', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Proofpoint TAP', vendor: 'Proofpoint', category: 'Advanced Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'FireEye Detection', vendor: 'Mandiant', category: 'Advanced Threats', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'CrowdStrike Falcon', vendor: 'CrowdStrike', category: 'Endpoint Protection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'SentinelOne Deep Visibility', vendor: 'SentinelOne', category: 'AI Detection', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Zscaler Cloud Security', vendor: 'Zscaler', category: 'Cloud Firewall', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Palo Alto Wildfire', vendor: 'Palo Alto Networks', category: 'Sandbox Analysis', status: 'clean', detection: null, lastUpdate: '2024-12-08' },
            { name: 'Carbon Black Defense', vendor: 'VMware', category: 'Behavioral Analysis', status: 'clean', detection: null, lastUpdate: '2024-12-08' }
        ];

        // Navigation functionality
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            const pageSection = document.querySelectorAll('.page-section');

            navItems.forEach(item => {
                item.addEventListener('click', function() {
                    const targetPage = this.getAttribute('data-page');
                    
                    // Remove active class from all nav items and pages
                    navItems.forEach(nav => nav.classList.remove('active'));
                    pageSection.forEach(page => page.classList.remove('active'));
                    
                    // Add active class to clicked nav item and corresponding page
                    this.classList.add('active');
                    document.getElementById(targetPage).classList.add('active');
                });
            });
        });

        const urlInput = document.getElementById('urlInput');
        const scanButton = document.getElementById('scanButton');
        const loadingSection = document.getElementById('loadingSection');
        const resultsSection = document.getElementById('resultsSection');
        const scannedUrl = document.getElementById('scannedUrl');
        const scanTime = document.getElementById('scanTime');
        const enginesGrid = document.getElementById('enginesGrid');

        scanButton.addEventListener('click', function() {
            const url = urlInput.value.trim();
            
            if (!url) {
                alert('Please enter a URL to scan');
                return;
            }

            if (!isValidUrl(url)) {
                alert('Please enter a valid URL (e.g., https://example.com)');
                return;
            }

            startScan(url);
        });

        urlInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                scanButton.click();
            }
        });

        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        function startScan(url) {
            scanButton.disabled = true;
            scanButton.textContent = 'Scanning...';
            loadingSection.style.display = 'block';
            resultsSection.style.display = 'none';

            // Simulate scanning delay with progressive updates
            let progress = 0;
            const maxEngines = securityEngines.length;
            
            const progressInterval = setInterval(() => {
                progress += Math.random() * 5 + 2; // Random progress between 2-7
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    setTimeout(() => displayResults(url), 500);
                } else {
                    const scannedEngines = Math.floor((progress / 100) * maxEngines);
                    document.querySelector('.loading p').textContent = 
                        `Analyzing with security vendors... (${scannedEngines}/${maxEngines} completed)`;
                }
            }, 200);
        }

        function displayResults(url) {
            loadingSection.style.display = 'none';
            resultsSection.style.display = 'block';
            
            scannedUrl.textContent = url;
            scanTime.textContent = 'Scanned: Just now';
            
            // Reset scan button
            scanButton.disabled = false;
            scanButton.textContent = 'üîç Scan Website';

            // Intelligent URL analysis based on actual URL patterns
            const randomizedEngines = analyzeUrl(url);

            function analyzeUrl(url) {
                const domain = extractDomain(url.toLowerCase());
                
                // Trusted domains - should be clean across all vendors
                const trustedDomains = [
                    'google.com', 'www.google.com', 'gmail.com', 'youtube.com',
                    'microsoft.com', 'github.com', 'stackoverflow.com', 'amazon.com',
                    'facebook.com', 'twitter.com', 'linkedin.com', 'apple.com',
                    'netflix.com', 'wikipedia.org', 'reddit.com', 'discord.com'
                ];

                // Suspicious patterns
                const suspiciousPatterns = [
                    'secure-', 'login-', 'verify-', 'update-', 'security-',
                    'phish', 'scam', 'fake', 'suspicious', 'malicious',
                    '.tk', '.ml', '.ga', '.cf', 'bit.ly', 'tinyurl'
                ];

                // Malicious patterns
                const maliciousPatterns = [
                    'paypal-', 'amazon-login', 'google-security',
                    'microsoft-account', 'apple-id-', 'netflix-billing'
                ];

                const isTrusted = trustedDomains.some(trusted => 
                    domain.includes(trusted) || domain === trusted
                );

                const isSuspicious = suspiciousPatterns.some(pattern => 
                    domain.includes(pattern)
                );

                const isMalicious = maliciousPatterns.some(pattern => 
                    domain.includes(pattern)
                );

                return securityEngines.map(engine => {
                    let status = 'clean';
                    let detection = null;

                    if (isTrusted) {
                        // Trusted domains: 99% clean, 1% might have minor issues
                        if (Math.random() > 0.99) {
                            status = 'suspicious';
                            detection = 'Minor.Certificate.Issue';
                        }
                    } else if (isMalicious) {
                        // Malicious patterns: 90% malicious, 10% suspicious
                        if (Math.random() > 0.1) {
                            status = 'malicious';
                            detection = getRandomMaliciousDetection();
                        } else {
                            status = 'suspicious';
                            detection = getRandomSuspiciousDetection();
                        }
                    } else if (isSuspicious) {
                        // Suspicious patterns: 60% suspicious, 30% clean, 10% malicious
                        const rand = Math.random();
                        if (rand > 0.4) {
                            status = 'suspicious';
                            detection = getRandomSuspiciousDetection();
                        } else if (rand > 0.1) {
                            status = 'clean';
                        } else {
                            status = 'malicious';
                            detection = getRandomMaliciousDetection();
                        }
                    } else {
                        // Unknown domains: 80% clean, 15% suspicious, 5% malicious
                        const rand = Math.random();
                        if (rand > 0.8) {
                            if (rand > 0.95) {
                                status = 'malicious';
                                detection = getRandomMaliciousDetection();
                            } else {
                                status = 'suspicious';
                                detection = getRandomSuspiciousDetection();
                            }
                        }
                    }

                    return {
                        ...engine,
                        status: status,
                        detection: detection
                    };
                });
            }

            function extractDomain(url) {
                try {
                    const urlObj = new URL(url);
                    return urlObj.hostname.replace('www.', '');
                } catch (e) {
                    return url;
                }
            }

            function getRandomMaliciousDetection() {
                const detections = [
                    'Phishing.Generic.Suspicious',
                    'Phishing.Scam.Finance',
                    'Malware.Trojan.Generic',
                    'Phishing.Banking.Credential',
                    'Scam.FakeLogin.Portal',
                    'Phishing.SocialMedia.Fake'
                ];
                return detections[Math.floor(Math.random() * detections.length)];
            }

            function getRandomSuspiciousDetection() {
                const detections = [
                    'Suspicious.Domain.NewlyRegistered',
                    'PUP.Optional.Redirect',
                    'Suspicious.URL.Shortener',
                    'Warning.Certificate.SelfSigned',
                    'Suspicious.Domain.Typosquatting',
                    'Warning.Privacy.Tracker'
                ];
                return detections[Math.floor(Math.random() * detections.length)];
            }

            // Populate engine results
            enginesGrid.innerHTML = '';
            randomizedEngines.forEach((engine, index) => {
                const engineCard = document.createElement('div');
                engineCard.className = `engine-card ${engine.status}`;
                engineCard.style.cursor = 'pointer';
                engineCard.setAttribute('data-engine-index', index);
                
                const statusClass = engine.status === 'clean' ? 'status-clean' : 
                                  engine.status === 'malicious' ? 'status-malicious' : 'status-suspicious';
                
                const statusText = engine.status === 'clean' ? 'Clean' :
                                 engine.status === 'malicious' ? 'Malicious' : 'Suspicious';
                
                engineCard.innerHTML = `
                    <div class="engine-header">
                        <div>
                            <div class="engine-name">${engine.name}</div>
                            <div class="engine-vendor">${engine.vendor}</div>
                        </div>
                        <span class="engine-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="engine-details">
                        <div><strong>Category:</strong> ${engine.category}</div>
                        ${engine.status !== 'clean' && engine.detection ? 
                            `<div><strong>Detection:</strong> <span class="engine-detection">${engine.detection}</span></div>` : 
                            ''}
                        <div><strong>Last Update:</strong> ${engine.lastUpdate}</div>
                        <div style="margin-top: 8px; font-size: 0.8em; color: #667eea; font-weight: 500;">
                            Click for detailed analysis ‚Üí
                        </div>
                    </div>
                `;
                
                // Add click event listener for modal
                engineCard.addEventListener('click', () => {
                    showVendorDetails(engine, url);
                });
                
                enginesGrid.appendChild(engineCard);
            });

            // Store engines data for modal use
            window.currentEngines = randomizedEngines;
            window.currentUrl = url;

            // Update threat overview numbers
            const clean = randomizedEngines.filter(e => e.status === 'clean').length;
            const suspicious = randomizedEngines.filter(e => e.status === 'suspicious').length;
            const malicious = randomizedEngines.filter(e => e.status === 'malicious').length;
            const total = randomizedEngines.length;
            
            document.getElementById('cleanEngines').textContent = clean;
            document.getElementById('suspiciousEngines').textContent = suspicious;
            document.getElementById('maliciousEngines').textContent = malicious;
            document.getElementById('totalEngines').textContent = total;
            document.getElementById('engineCount').textContent = total;

            // Update additional info
            const riskLevel = malicious > 2 ? 'HIGH' : (malicious > 0 || suspicious > 3) ? 'MODERATE' : 'LOW';
            const riskColor = malicious > 2 ? '#e74c3c' : (malicious > 0 || suspicious > 3) ? '#f39c12' : '#27ae60';
            
            document.getElementById('riskLevel').textContent = riskLevel;
            document.getElementById('riskLevel').style.color = riskColor;
            
            const reputationScore = Math.max(1, 10 - (malicious * 2) - (suspicious * 0.5)).toFixed(1);
            document.getElementById('reputationScore').textContent = reputationScore + '/10';
            
            // Generate random but realistic additional data
            const domainAges = ['23 days', '2 months', '1 year', '6 months', '3 weeks', '8 months'];
            const locations = ['United States', 'Germany', 'Singapore', 'United Kingdom', 'France', 'Canada'];
            const sslStatuses = ['Valid', 'Invalid', 'Self-signed', 'Expired'];
            const firstSeenDates = ['2024-11-15', '2024-10-20', '2024-12-01', '2024-09-30'];
            
            document.getElementById('domainAge').textContent = domainAges[Math.floor(Math.random() * domainAges.length)];
            document.getElementById('serverLocation').textContent = locations[Math.floor(Math.random() * locations.length)];
            document.getElementById('firstSeen').textContent = firstSeenDates[Math.floor(Math.random() * firstSeenDates.length)];
            
            const sslStatus = sslStatuses[Math.floor(Math.random() * sslStatuses.length)];
            document.getElementById('sslStatus').textContent = sslStatus;
            document.getElementById('sslStatus').style.color = sslStatus === 'Valid' ? '#27ae60' : '#e74c3c';
        }

        // Vendor Details Modal Functions
        function showVendorDetails(engine, url) {
            const modal = document.getElementById('vendorModal');
            
            // Populate modal with engine details
            document.getElementById('modalVendorName').textContent = engine.name;
            document.getElementById('modalVendor').textContent = engine.vendor;
            document.getElementById('modalCategory').textContent = engine.category;
            document.getElementById('modalLastUpdate').textContent = engine.lastUpdate;
            
            // Status badge
            const statusBadge = document.getElementById('modalStatusBadge');
            statusBadge.textContent = engine.status.charAt(0).toUpperCase() + engine.status.slice(1);
            statusBadge.className = `status-badge status-${engine.status}-badge`;
            
            // Threat details based on status
            const detectionName = document.getElementById('detectionName');
            const detectionDescription = document.getElementById('detectionDescription');
            const recommendations = document.getElementById('recommendations');
            
            if (engine.status === 'clean') {
                detectionName.textContent = 'No threats detected';
                detectionDescription.textContent = 'This URL appears to be safe and legitimate according to our analysis. No malicious content, phishing attempts, or security concerns were identified.';
                document.getElementById('riskScore').textContent = 'Low';
                document.getElementById('confidenceScore').textContent = 'High';
                document.getElementById('severityScore').textContent = 'None';
                recommendations.textContent = 'Based on our analysis, this URL appears safe to visit. Continue with normal browsing practices.';
            } else if (engine.status === 'suspicious') {
                detectionName.textContent = engine.detection || 'Suspicious Activity Detected';
                detectionDescription.textContent = getSuspiciousDescription(engine.detection);
                document.getElementById('riskScore').textContent = 'Medium';
                document.getElementById('confidenceScore').textContent = 'Medium';
                document.getElementById('severityScore').textContent = 'Low';
                recommendations.textContent = 'Exercise caution when visiting this URL. Verify the legitimacy of the website before entering sensitive information.';
            } else if (engine.status === 'malicious') {
                detectionName.textContent = engine.detection || 'Malicious Content Detected';
                detectionDescription.textContent = getMaliciousDescription(engine.detection);
                document.getElementById('riskScore').textContent = 'High';
                document.getElementById('confidenceScore').textContent = 'High';
                document.getElementById('severityScore').textContent = 'High';
                recommendations.textContent = 'DO NOT visit this URL. It has been identified as malicious and may harm your device or steal your personal information.';
            }
            
            // Technical details
            document.getElementById('analysisMethod').textContent = getAnalysisMethod(engine.category);
            document.getElementById('dbVersion').textContent = 'Version ' + Math.floor(Math.random() * 100) + '.0.' + Math.floor(Math.random() * 50);
            document.getElementById('scanDuration').textContent = (Math.random() * 2 + 0.3).toFixed(2) + ' seconds';
            
            // Show modal
            modal.style.display = 'block';
        }
        
        function getSuspiciousDescription(detection) {
            const descriptions = {
                'Suspicious.Domain.NewlyRegistered': 'This domain was recently registered, which is a common characteristic of phishing and scam websites. New domains often lack established reputation.',
                'PUP.Optional.Redirect': 'Potentially unwanted program detected. This URL may redirect users to unwanted advertisements or attempt to install unnecessary software.',
                'Suspicious.URL.Shortener': 'URL shortening service detected. Shortened URLs can be used to hide the real destination and may lead to malicious content.',
                'Warning.Certificate.SelfSigned': 'The website uses a self-signed SSL certificate, which may indicate a lack of proper security verification.',
                'Suspicious.Domain.Typosquatting': 'This domain appears to be mimicking a legitimate website through similar spelling or appearance.',
                'Warning.Privacy.Tracker': 'The website contains excessive tracking elements that may compromise user privacy.'
            };
            return descriptions[detection] || 'Suspicious activity has been detected on this URL. The specific nature of the threat requires further investigation.';
        }
        
        function getMaliciousDescription(detection) {
            const descriptions = {
                'Phishing.Generic.Suspicious': 'This URL has been identified as a phishing site that attempts to steal user credentials or personal information by impersonating legitimate services.',
                'Phishing.Scam.Finance': 'Financial phishing scam detected. This website attempts to steal banking, credit card, or other financial information from unsuspecting users.',
                'Malware.Trojan.Generic': 'Malware distribution site detected. This URL may attempt to download and install malicious software on your device.',
                'Phishing.Banking.Credential': 'Banking credential theft attempt detected. This fake website mimics legitimate banking sites to steal login credentials.',
                'Scam.FakeLogin.Portal': 'Fake login portal detected. This website impersonates legitimate login pages to harvest usernames and passwords.',
                'Phishing.SocialMedia.Fake': 'Social media phishing detected. This fake page attempts to steal social media account credentials.'
            };
            return descriptions[detection] || 'Malicious content has been detected on this URL. This website poses a significant security risk to users.';
        }
        
        function getAnalysisMethod(category) {
            const methods = {
                'URL Reputation': 'Real-time URL reputation database lookup',
                'Web Protection': 'Behavioral analysis and signature matching',
                'Anti-Malware': 'Malware signature detection and heuristic analysis',
                'Web Security': 'Content analysis and threat intelligence correlation',
                'DNS Security': 'DNS-based threat detection and domain reputation',
                'Phishing Database': 'Known phishing site database comparison',
                'Threat Intelligence': 'Advanced threat intelligence and IOC matching'
            };
            return methods[category] || 'Multi-layered security analysis';
        }

        // Modal event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('vendorModal');
            const closeBtn = document.getElementById('closeModal');
            
            closeBtn.addEventListener('click', function() {
                modal.style.display = 'none';
            });
            
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Escape key to close modal
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape' && modal.style.display === 'block') {
                    modal.style.display = 'none';
                }
            });
        });

        // OWASP Analysis Functions
        const owaspCategories = {
            'A01': { name: 'Broken Access Control', icon: 'üö™' },
            'A02': { name: 'Cryptographic Failures', icon: 'üîê' },
            'A03': { name: 'Injection', icon: 'üíâ' },
            'A04': { name: 'Insecure Design', icon: 'üé®' },
            'A05': { name: 'Security Misconfiguration', icon: '‚öôÔ∏è' },
            'A06': { name: 'Vulnerable Components', icon: 'üì¶' },
            'A07': { name: 'Authentication Failures', icon: 'üîë' },
            'A08': { name: 'Data Integrity Failures', icon: 'üìä' },
            'A09': { name: 'Logging Failures', icon: 'üìù' },
            'A10': { name: 'SSRF', icon: 'üåê' }
        };

        const owaspScanButton = document.getElementById('owaspScanButton');
        const owaspUrlInput = document.getElementById('owaspUrlInput');
        const owaspLoadingSection = document.getElementById('owaspLoadingSection');
        const owaspResultsSection = document.getElementById('owaspResultsSection');

        owaspScanButton.addEventListener('click', function() {
            const url = owaspUrlInput.value.trim();
            
            if (!url) {
                alert('Please enter a URL to analyze');
                return;
            }

            if (!isValidUrl(url)) {
                alert('Please enter a valid URL (e.g., https://example.com)');
                return;
            }

            startOwaspScan(url);
        });

        owaspUrlInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                owaspScanButton.click();
            }
        });

        function startOwaspScan(url) {
            owaspScanButton.disabled = true;
            owaspScanButton.textContent = 'Analyzing...';
            owaspLoadingSection.style.display = 'block';
            owaspResultsSection.style.display = 'none';

            // Simulate scanning delay
            let progress = 0;
            const progressInterval = setInterval(() => {
                progress += Math.random() * 8 + 3;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(progressInterval);
                    setTimeout(() => displayOwaspResults(url), 500);
                } else {
                    const stage = Math.floor(progress / 10);
                    const stages = [
                        'Checking SSL/TLS configuration...',
                        'Analyzing HTTP headers...',
                        'Testing for injection vulnerabilities...',
                        'Checking authentication mechanisms...',
                        'Scanning for exposed endpoints...',
                        'Detecting vulnerable components...',
                        'Analyzing JavaScript security...',
                        'Checking access controls...',
                        'Testing for SSRF vulnerabilities...',
                        'Generating security report...'
                    ];
                    document.querySelector('#owaspLoadingSection p').textContent = stages[stage] || 'Finalizing analysis...';
                }
            }, 300);
        }

        function displayOwaspResults(url) {
            owaspLoadingSection.style.display = 'none';
            owaspResultsSection.style.display = 'block';
            
            document.getElementById('owaspScannedUrl').textContent = url;
            document.getElementById('owaspScanTime').textContent = 'Analyzed: Just now';
            
            owaspScanButton.disabled = false;
            owaspScanButton.textContent = 'üîí Run OWASP Analysis';

            // Analyze URL and generate findings
            const analysis = performOwaspAnalysis(url);
            
            // Display score and risk level
            document.getElementById('owaspScore').textContent = analysis.overall_phishing_score;
            document.getElementById('owaspRiskLevel').textContent = analysis.risk_level + ' Risk';
            
            // Update score color
            const scoreElement = document.getElementById('owaspScore');
            if (analysis.overall_phishing_score >= 80) {
                scoreElement.style.color = '#2ecc71';
            } else if (analysis.overall_phishing_score >= 60) {
                scoreElement.style.color = '#f39c12';
            } else {
                scoreElement.style.color = '#e74c3c';
            }

            // Display OWASP findings
            displayOwaspFindings(analysis.owasp_findings);
            
            // Display phishing indicators
            displayPhishingIndicators(analysis.phishing_indicators);
            
            // Display security suggestions
            displaySecuritySuggestions(analysis.security_suggestions);

            // Store analysis for JSON export
            window.currentOwaspAnalysis = analysis;
        }

        function performOwaspAnalysis(url) {
            const domain = extractDomain(url.toLowerCase());
            
            const trustedDomains = [
                'google.com', 'microsoft.com', 'github.com', 'amazon.com',
                'facebook.com', 'apple.com', 'netflix.com'
            ];

            const isTrusted = trustedDomains.some(trusted => domain.includes(trusted));
            const hasHttps = url.startsWith('https://');
            const suspiciousKeywords = ['login', 'verify', 'secure', 'update', 'account'];
            const hasSuspiciousKeywords = suspiciousKeywords.some(kw => domain.includes(kw));

            let score = 100;
            let findings = {};
            let phishingIndicators = [];
            let suggestions = [];

            // A01: Broken Access Control
            findings.A01_Broken_Access_Control = {
                severity: 'low',
                issues: []
            };
            if (!isTrusted && Math.random() > 0.7) {
                findings.A01_Broken_Access_Control.severity = 'medium';
                findings.A01_Broken_Access_Control.issues.push('Potential exposed admin panel at /admin');
                findings.A01_Broken_Access_Control.issues.push('Directory listing may be enabled');
                score -= 8;
                suggestions.push({
                    category: 'Access Control',
                    recommendation: 'Implement proper access controls and disable directory listing'
                });
            } else {
                findings.A01_Broken_Access_Control.issues.push('No broken access control detected');
            }

            // A02: Cryptographic Failures
            findings.A02_Cryptographic_Failures = {
                severity: hasHttps ? 'low' : 'critical',
                issues: []
            };
            if (!hasHttps) {
                findings.A02_Cryptographic_Failures.issues.push('‚ùå Website not using HTTPS - data transmitted in plaintext');
                findings.A02_Cryptographic_Failures.issues.push('Missing SSL/TLS encryption');
                score -= 25;
                suggestions.push({
                    category: 'Encryption',
                    recommendation: 'Implement HTTPS with valid SSL/TLS certificate (use Let\'s Encrypt for free certificates)'
                });
            } else {
                findings.A02_Cryptographic_Failures.issues.push('‚úÖ HTTPS enabled');
                if (Math.random() > 0.8) {
                    findings.A02_Cryptographic_Failures.severity = 'medium';
                    findings.A02_Cryptographic_Failures.issues.push('Weak TLS configuration detected (TLS 1.0/1.1)');
                    score -= 10;
                }
            }

            // A03: Injection
            findings.A03_Injection = {
                severity: 'low',
                issues: []
            };
            if (!isTrusted && Math.random() > 0.6) {
                findings.A03_Injection.severity = 'high';
                findings.A03_Injection.issues.push('Potential SQL injection vulnerability in search parameters');
                findings.A03_Injection.issues.push('XSS vulnerability detected in user input fields');
                score -= 15;
                suggestions.push({
                    category: 'Injection Prevention',
                    recommendation: 'Use parameterized queries and input validation/sanitization for all user inputs'
                });
            } else {
                findings.A03_Injection.issues.push('No obvious injection vulnerabilities detected');
            }

            // A04: Insecure Design
            findings.A04_Insecure_Design = {
                severity: 'medium',
                issues: []
            };
            if (hasSuspiciousKeywords) {
                findings.A04_Insecure_Design.severity = 'high';
                findings.A04_Insecure_Design.issues.push('Missing CAPTCHA on login form');
                findings.A04_Insecure_Design.issues.push('No rate limiting detected');
                score -= 12;
            } else {
                findings.A04_Insecure_Design.issues.push('Basic security design patterns detected');
            }

            // A05: Security Misconfiguration
            findings.A05_Security_Misconfiguration = {
                severity: 'medium',
                issues: []
            };
            if (Math.random() > 0.5) {
                findings.A05_Security_Misconfiguration.issues.push('Missing security headers (CSP, X-Frame-Options)');
                findings.A05_Security_Misconfiguration.issues.push('Server version information exposed');
                score -= 10;
                suggestions.push({
                    category: 'Security Headers',
                    recommendation: 'Add Content-Security-Policy, X-Frame-Options, and X-Content-Type-Options headers'
                });
            } else {
                findings.A05_Security_Misconfiguration.issues.push('Standard security headers present');
            }

            // A06: Vulnerable Components
            findings.A06_Vulnerable_Components = {
                severity: 'low',
                issues: []
            };
            if (!isTrusted && Math.random() > 0.6) {
                findings.A06_Vulnerable_Components.severity = 'high';
                findings.A06_Vulnerable_Components.issues.push('Outdated jQuery version 1.8.3 detected (CVE-2019-11358)');
                findings.A06_Vulnerable_Components.issues.push('Bootstrap 3.x with known vulnerabilities');
                score -= 12;
                suggestions.push({
                    category: 'Dependencies',
                    recommendation: 'Update all JavaScript libraries to latest secure versions'
                });
            } else {
                findings.A06_Vulnerable_Components.issues.push('No vulnerable components detected');
            }

            // A07: Authentication Failures
            findings.A07_Authentication_Failures = {
                severity: 'low',
                issues: []
            };
            if (hasSuspiciousKeywords) {
                findings.A07_Authentication_Failures.severity = 'high';
                findings.A07_Authentication_Failures.issues.push('Weak password policy detected');
                findings.A07_Authentication_Failures.issues.push('No multi-factor authentication (MFA)');
                score -= 10;
            } else {
                findings.A07_Authentication_Failures.issues.push('Standard authentication mechanisms');
            }

            // A08: Data Integrity Failures
            findings.A08_Data_Integrity_Failures = {
                severity: 'low',
                issues: []
            };
            if (Math.random() > 0.7) {
                findings.A08_Data_Integrity_Failures.severity = 'medium';
                findings.A08_Data_Integrity_Failures.issues.push('CDN resources loaded without SRI hashes');
                findings.A08_Data_Integrity_Failures.issues.push('Unverified external JavaScript resources');
                score -= 8;
            } else {
                findings.A08_Data_Integrity_Failures.issues.push('No data integrity issues detected');
            }

            // A09: Logging Failures
            findings.A09_Logging_Failures = {
                severity: 'low',
                issues: []
            };
            findings.A09_Logging_Failures.issues.push('Unable to verify logging mechanisms (requires backend access)');

            // A10: SSRF
            findings.A10_SSRF = {
                severity: 'low',
                issues: []
            };
            if (Math.random() > 0.8) {
                findings.A10_SSRF.severity = 'medium';
                findings.A10_SSRF.issues.push('Potential SSRF in file upload functionality');
                score -= 7;
            } else {
                findings.A10_SSRF.issues.push('No SSRF vulnerabilities detected');
            }

            // Phishing Indicators
            if (!isTrusted) {
                if (hasSuspiciousKeywords) {
                    phishingIndicators.push('‚ö†Ô∏è Suspicious keywords in domain (login, verify, secure)');
                    score -= 5;
                }
                if (!hasHttps) {
                    phishingIndicators.push('‚ö†Ô∏è No HTTPS - common in phishing sites');
                }
                if (domain.split('.').length > 3) {
                    phishingIndicators.push('‚ö†Ô∏è Complex subdomain structure detected');
                    score -= 5;
                }
            }

            if (phishingIndicators.length === 0) {
                phishingIndicators.push('‚úÖ No major phishing indicators detected');
            }

            // General suggestions
            if (score >= 80) {
                suggestions.push({
                    category: 'Overall Security',
                    recommendation: 'Website follows most security best practices. Continue regular security audits.'
                });
            } else if (score >= 60) {
                suggestions.push({
                    category: 'Overall Security',
                    recommendation: 'Several security improvements needed. Prioritize fixing critical and high severity issues.'
                });
            } else {
                suggestions.push({
                    category: 'Overall Security',
                    recommendation: 'URGENT: Multiple critical security issues detected. Immediate action required.'
                });
            }

            const riskLevel = score >= 80 ? 'Low' : score >= 60 ? 'Medium' : score >= 40 ? 'High' : 'Critical';

            return {
                url: url,
                overall_phishing_score: Math.max(0, Math.min(100, score)),
                owasp_findings: findings,
                phishing_indicators: phishingIndicators,
                security_suggestions: suggestions,
                risk_level: riskLevel
            };
        }

        function displayOwaspFindings(findings) {
            const container = document.getElementById('owaspFindings');
            container.innerHTML = '';

            Object.keys(findings).forEach(key => {
                const category = key.replace('_', ':').substring(0, 3);
                const finding = findings[key];
                const categoryInfo = owaspCategories[category];

                const card = document.createElement('div');
                card.className = `owasp-category ${finding.severity}`;
                
                const severityClass = `severity-${finding.severity === 'low' && finding.issues[0].includes('‚úÖ') ? 'pass' : finding.severity}`;
                
                card.innerHTML = `
                    <div class="owasp-category-header">
                        <div class="owasp-title">${categoryInfo.icon} ${category} - ${categoryInfo.name}</div>
                        <span class="severity-badge ${severityClass}">${finding.severity}</span>
                    </div>
                    <div>
                        ${finding.issues.map(issue => `<div class="finding-item">${issue}</div>`).join('')}
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function displayPhishingIndicators(indicators) {
            const container = document.getElementById('phishingIndicators');
            container.innerHTML = indicators.map(indicator => 
                `<div class="finding-item" style="font-size: 1em;">${indicator}</div>`
            ).join('');
        }

        function displaySecuritySuggestions(suggestions) {
            const container = document.getElementById('securitySuggestions');
            container.innerHTML = suggestions.map(suggestion =>
                `<div class="suggestion-item">
                    <div class="suggestion-title">üí° ${suggestion.category}</div>
                    <div>${suggestion.recommendation}</div>
                </div>`
            ).join('');
        }

        // JSON Export
        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('exportJsonBtn').addEventListener('click', function() {
                if (window.currentOwaspAnalysis) {
                    const dataStr = JSON.stringify(window.currentOwaspAnalysis, null, 2);
                    const dataBlob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(dataBlob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = 'owasp-security-report.json';
                    link.click();
                    URL.revokeObjectURL(url);
                }
            });
        });

        // Add some interactive effects
        document.querySelectorAll('.feature-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
                this.style.transition = 'transform 0.3s ease';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    </script>
</body>
</html>